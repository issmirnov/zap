# Default values for zap.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# ============================================================================
# COMMON CUSTOMIZATIONS - Values you'll likely want to override
# ============================================================================

# Image configuration
# üëâ Update these if using a custom registry or specific version
image:
  # Image repository
  repository: ghcr.io/issmirnov/zap
  # Image pull policy
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion
  tag: ""

# Service configuration
# üëâ Customize type, ports, and LoadBalancer settings for your environment
# See service: section below (line 50+)

# Zap shortcuts configuration
# üëâ THIS IS THE MAIN THING TO CUSTOMIZE
# See zap.config: section below (line 150+)

# ============================================================================
# STANDARD KUBERNETES SETTINGS - Usually fine as defaults
# ============================================================================

# Number of replicas (1 is usually sufficient for most use cases)
# ‚ö†Ô∏è Usually no need to change this
replicaCount: 1

# Image pull secrets for private registries
imagePullSecrets: []

# Override the name of the chart
nameOverride: ""
# Override the full name of the release
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podAnnotations: {}
  # Example annotations for Reloader (optional - enables automatic reload on ConfigMap changes)
  # reloader.stakater.com/auto: "true"

# Security contexts - Best practices for production
# ‚ö†Ô∏è Usually no need to change these
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  runAsGroup: 1000
  fsGroup: 1000

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true

service:
  # Service type: LoadBalancer, ClusterIP, or NodePort
  # üëâ Change to ClusterIP if using Ingress instead
  type: LoadBalancer

  # Port the service will expose (standard HTTP port)
  # üëâ Usually keep as 80 for easy access
  port: 80

  # Target port on the container (Zap's default port)
  # ‚ö†Ô∏è Should match zap.port below - usually no need to change
  targetPort: 8927

  # Node port (only used if type is NodePort)
  nodePort: null

  # LoadBalancer-specific settings
  # üëâ Configure these for self-hosted k8s or to restrict access
  loadBalancer:
    # Manually specify LoadBalancer IP (optional)
    # Useful for self-hosted k8s with MetalLB or Cilium BGP
    # Example: ip: "192.168.1.100"
    ip: ""

    # Source IP ranges that can access the LoadBalancer
    # Use to restrict access to your network only
    sourceRanges: []
    # Example:
    # sourceRanges:
    #   - "10.0.0.0/8"
    #   - "192.168.0.0/16"

  # Service annotations (for MetalLB, Cilium BGP, cloud providers, etc.)
  annotations: {}
    # Example for Cilium BGP:
    # io.cilium/lb-ipam-ips: "192.168.1.100"
    #
    # Example for MetalLB:
    # metallb.universe.tf/address-pool: default
    # metallb.universe.tf/allow-shared-ip: zap
    #
    # Example for AWS:
    # service.beta.kubernetes.io/aws-load-balancer-type: nlb
    # service.beta.kubernetes.io/aws-load-balancer-internal: "true"
    #
    # Example for GCP:
    # cloud.google.com/load-balancer-type: "Internal"

  # Service labels
  labels: {}
    # Example for Cilium BGP:
    # bgp: "true"

ingress:
  enabled: false
  className: ""
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  hosts:
    - host: zap.local
      paths:
        - path: /
          pathType: Prefix
  tls: []
  #  - secretName: zap-tls
  #    hosts:
  #      - zap.local

# Resource limits and requests
# These defaults are suitable for typical Zap workloads (handles 150k+ QPS)
# ‚ö†Ô∏è Usually no need to change unless you have specific requirements
resources:
  limits:
    cpu: 500m
    memory: 128Mi
  requests:
    cpu: 100m
    memory: 50Mi

# Autoscaling (optional - usually not needed for Zap)
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80

nodeSelector: {}

tolerations: []

affinity: {}

# Zap-specific configuration
# Note: These are sensible defaults for Kubernetes. Most users only need to customize zap.config
zap:
  # Port Zap will bind to inside the container (default: 8927)
  # ‚ö†Ô∏è Usually no need to change this
  port: 8927

  # Host Zap will bind to (0.0.0.0 for all interfaces in k8s)
  # ‚ö†Ô∏è Usually no need to change this
  host: "0.0.0.0"

  # Advertised IP (used for /etc/hosts, but disabled in k8s via ZAP_DISABLE_HOSTS_UPDATE)
  # ‚ö†Ô∏è Usually no need to change this
  advertise: "127.0.0.1"

  # Configuration file content (c.yml)
  # üëâ THIS IS WHAT YOU CUSTOMIZE - define your shortcuts here
  config: |
    # Common shortcuts
    g:
      expand: github.com
      z:
        expand: issmirnov/zap
      issues:
        expand: issmirnov/zap/issues
    gh:
      expand: github.com
    r:
      expand: reddit.com/r
    hn:
      expand: news.ycombinator.com

    # Search shortcuts
    s:
      query: google.com/search?q=
    so:
      query: stackoverflow.com/search?q=

    # Add your own shortcuts below
    # Examples:
    # d:
    #   expand: drive.google.com
    # docs:
    #   expand: docs.google.com
    # gm:
    #   expand: gmail.com

# Hot reload support
# Stakater Reloader can automatically restart pods when ConfigMap changes
# Install: https://github.com/stakater/Reloader
# If you have Reloader installed, set podAnnotations.reloader.stakater.com/auto: "true"
hotReload:
  # Note: Zap has built-in hot reload via inotify, which should work with ConfigMap volume updates
  # Reloader is optional and provides additional restart capability if needed
  enabled: false

# Health check configuration
# ‚ö†Ô∏è Usually no need to change these - production-ready defaults
healthCheck:
  enabled: true
  # Path for liveness probe
  livenessPath: /healthz
  # Path for readiness probe
  readinessPath: /healthz
  # Probe settings
  livenessProbe:
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 3
    failureThreshold: 3
  readinessProbe:
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3
